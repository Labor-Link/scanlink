<Window x:Class="ScanLinkPrinter.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:ScanLinkPrinter.App"
        xmlns:proto="clr-namespace:ScanLinkPrinter.Protocol;assembly=ScanLinkPrinter.Protocol"
        mc:Ignorable="d"
        Title="Scan Link Printer" Height="420" Width="680">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Text="Connection" Style="{StaticResource TitleText}"/>

        <StackPanel Orientation="Horizontal" Grid.Row="1" Margin="0,8,0,8" VerticalAlignment="Top">
            <TextBlock Text="Provider:" VerticalAlignment="Center" Margin="0,0,8,0"/>
            <ComboBox x:Name="ProviderCombo" Width="160" SelectedIndex="0" ToolTip="Printer provider">
                <ComboBoxItem Content="Argox"/>
            </ComboBox>

            <CheckBox x:Name="AutoReconnectCheck" Content="Auto reconnect on start" Margin="16,0,0,0" VerticalAlignment="Center"/>

            <TextBlock Text="Type:" VerticalAlignment="Center" Margin="24,0,8,0"/>
            <ComboBox x:Name="ConnectionTypeCombo" Width="160" SelectedIndex="0">
                <ComboBoxItem Content="File"/>
                <ComboBoxItem Content="Serial"/>
                <ComboBoxItem Content="USB"/>
                <ComboBoxItem Content="TCP/IP"/>
            </ComboBox>

            <StackPanel Orientation="Horizontal" Margin="24,0,0,0" VerticalAlignment="Center">
                <TextBlock Text="Target:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <ComboBox x:Name="TargetCombo" Width="280" IsEditable="True"/>
            </StackPanel>
            <Button x:Name="RefreshBtn" Content="Refresh" Width="90" Margin="8,0,0,0" Click="OnRefreshTargets"/>
            <Button x:Name="TestBtn" Content="Test" Width="90" Margin="8,0,0,0" Click="OnTestConnection"/>
        </StackPanel>

        <TabControl Grid.Row="2">
            <TabItem Header="Print">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="8">
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <TextBlock Text="Preset:" VerticalAlignment="Center"/>
                    <ComboBox x:Name="PresetCombo" Width="220" Margin="8,0,0,0" SelectionChanged="OnPresetChanged">
                        <ComboBoxItem Content="Custom"/>
                        <ComboBoxItem Content="4x6 Shipping (203dpi)"/>
                        <ComboBoxItem Content="2x1 Label (203dpi)"/>
                        <ComboBoxItem Content="3x2 Product (203dpi)"/>
                    </ComboBox>
                    <TextBox x:Name="PresetNameBox" Width="160" Margin="8,0,0,0"/>
                    <Button Content="Save Preset" Width="110" Margin="8,0,0,0" Click="OnSavePreset"/>
                    <Button Content="Reload" Width="90" Margin="8,0,0,0" Click="OnReloadPresets"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <StackPanel Width="300">
                        <TextBlock Text="Darkness (0-30)"/>
                        <Slider x:Name="DarknessSlider" Minimum="0" Maximum="30" Value="10"/>
                    </StackPanel>
                    <StackPanel Width="300" Margin="16,0,0,0">
                        <TextBlock Text="Print Rate (1-7)"/>
                        <Slider x:Name="RateSlider" Minimum="1" Maximum="7" Value="3"/>
                    </StackPanel>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                    <StackPanel Width="300">
                        <TextBlock Text="Label Length (dots)"/>
                        <TextBox x:Name="LabelLengthBox" Text="609"/>
                    </StackPanel>
                    <StackPanel Width="300" Margin="16,0,0,0">
                        <TextBlock Text="Print Width (dots)"/>
                        <TextBox x:Name="PrintWidthBox" Text="812"/>
                    </StackPanel>
                </StackPanel>
                <GroupBox Header="Barcode (optional)" Margin="0,0,0,8">
                    <StackPanel Margin="8">
                        <StackPanel Orientation="Horizontal">
                            <ComboBox x:Name="BarcodeSymCombo" Width="160">
                                <ComboBoxItem Content="Code128"/>
                                <ComboBoxItem Content="QR"/>
                                <ComboBoxItem Content="DataMatrix"/>
                                <ComboBoxItem Content="PDF417"/>
                            </ComboBox>
                            <TextBox x:Name="BarcodeDataBox" Width="360" Margin="8,0,0,0"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                            <TextBox x:Name="BarcodeXBox" Width="120" Text="50"/>
                            <TextBox x:Name="BarcodeYBox" Width="120" Margin="8,0,0,0" Text="110"/>
                            <TextBox x:Name="BarcodeHeightBox" Width="120" Margin="8,0,0,0" Text="100"/>
                            <TextBox x:Name="BarcodeModuleBox" Width="120" Margin="8,0,0,0" Text="3"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>
                <TextBox x:Name="TestText" Height="80" TextWrapping="Wrap" AcceptsReturn="True"/>
                <GroupBox Header="Image (optional)" Margin="0,8,0,0">
                    <StackPanel Margin="8">
                        <StackPanel Orientation="Horizontal">
                            <TextBox x:Name="ImagePathBox" Width="360"/>
                            <Button Content="Browse" Width="90" Margin="8,0,0,0" Click="OnBrowseImage"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                            <TextBox x:Name="ImageXBox" Width="120" Text="30"/>
                            <TextBox x:Name="ImageYBox" Width="120" Margin="8,0,0,0" Text="50"/>
                            <TextBox x:Name="ImageWidthBox" Width="120" Margin="8,0,0,0"/>
                            <TextBox x:Name="ImageHeightBox" Width="120" Margin="8,0,0,0"/>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>
                <StackPanel Orientation="Horizontal" Margin="0,8,0,0">
                    <Button Content="Print" Width="120" Height="32" HorizontalAlignment="Left" Click="OnPrintClick"/>
                    <Button Content="Calibrate" Width="120" Height="32" Margin="8,0,0,0" Click="OnCalibrateClick"/>
                </StackPanel>
                <TextBlock x:Name="StatusText" Margin="0,8,0,0"/>
            </StackPanel>
            </ScrollViewer>
            </TabItem>
            <TabItem Header="Preview">
                <Grid Margin="8">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <Button Content="Update Preview" Width="140" Click="OnUpdatePreview"/>
                        <TextBlock Text="(Scaled to fit)" Margin="8,0,0,0" VerticalAlignment="Center"/>
                    </StackPanel>
                    <Border Grid.Row="1" BorderBrush="LightGray" BorderThickness="1">
                        <Canvas x:Name="PreviewCanvas" Background="#FFF8F8F8" MinHeight="300" MinWidth="440"/>
                    </Border>
                </Grid>
            </TabItem>
            <TabItem Header="History">
                <ListBox x:Name="HistoryList" Margin="8"/>
            </TabItem>
        </TabControl>

        <StatusBar Grid.Row="3">
            <StatusBarItem>
                <TextBlock x:Name="StatusBarText"/>
            </StatusBarItem>
            <StatusBarItem>
                <ProgressBar x:Name="BusyBar" Width="120" Height="16" IsIndeterminate="True" Visibility="Collapsed"/>
            </StatusBarItem>
            <StatusBarItem>
                <StackPanel Orientation="Horizontal">
                    <Ellipse x:Name="ConnectionIndicator" Width="12" Height="12" Fill="Gray" Margin="0,0,6,0"/>
                    <TextBlock Text="Connection"/>
                </StackPanel>
            </StatusBarItem>
            <StatusBarItem>
                <Button Content="Copy Error" Width="100" Click="OnCopyError"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
